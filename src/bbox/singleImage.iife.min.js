!function(){const e={IN_DOM:"IN_DOM",VIEW_SIZE:"VIEW_SIZE",PAN_ZOOM:"PAN_ZOOM",ZOOM_MIN:"ZOOM_MIN",ZOOM_MAX:"ZOOM_MAX",SCROLLING_PARENT:"SCROLLING_PARENT",ZOOM_DISABLED:"ZOOM_DISABLED",ROTATE_DISABLED:"ROTATE_DISABLED",PAN_DISABLED:"PAN_DISABLED",ROTATE:"ROTATE",LOCALE:"LOCALE",IMAGE_CURRENT:"IMAGE_CURRENT",IMAGE_INFO:"IMAGE_INFO",IMAGE_INFO_ERROR:"IMAGE_INFO_ERROR",IMAGE_MSG:"IMAGE_MSG",CREDENTIALS:"CREDENTIALS",KEYBOARD_LISTEN:"KEYBOARD_LISTEN",DRAWING_ENABLED:"DRAWING_ENABLED",TOOLS_CONTROL:"TOOLS_CONTROL",grid:{IMAGES:"IMAGES",COLUMN_COUNT:"COLUMN_COUNT",selection:{ADD:"SELECTION_ADD",REMOVE:"SELECTION_REMOVE",CLEAR:"SELECTION_CLEAR"},HEADERS:"HEADERS",VISIBLE_IMAGES:"VISIBLE_IMAGES",MODE:"GRID_MODE",HORIZONTAL:"HORIZONTAL",SHOW_IMAGE_NUMBERS:"SHOW_IMAGE_NUMBERS"},overlays:{OVERLAYS:"OVERLAYS",ADD:"OVERLAY_ADD",UPDATE:"OVERLAY_UPDATE",DELETE:"OVERLAY_DELETE",highlights:{ADD:"OVERLAY_HIGHLIGHT_ADD",REMOVE:"OVERLAY_HIGHLIGHT_REMOVE",CLEAR:"OVERLAY_HIGHLIGHT_CLEAR"},selection:{ADD:"OVERLAY_SELECTION_ADD",REMOVE:"OVERLAY_SELECTION_REMOVE",CLEAR:"OVERLAY_SELECTION_CLEAR"}},markers:{MARKERS:"MARKERS",ADD:"MARKER_ADD",UPDATE:"MARKER_UPDATE",DELETE:"MARKER_DELETE"},user:{POINT_DOWN:"POINT_DOWN",POINT_UP:"POINT_UP",POINT_MOVE:"POINT_MOVE",SCROLL:"SCROLL"},filters:{BRIGHTNESS:"BRIGHTNESS",BRIGHTNESS_MIN:"BRIGHTNESS_MIN",BRIGHTNESS_MAX:"BRIGHTNESS_MAX",CONTRAST:"CONTRAST",CONTRAST_MIN:"CONTRAST_MIN",CONTRAST_MAX:"CONTRAST_MAX",INVERT:"INVERT"}},t=37,r=39,a=38,o=40,i=13,n=32,s=187,l=189,c=27,d={OBJECT:{},ARRAY:[]},g={PANNING:"PANNING",RESIZING:"RESIZING",MOVING:"MOVING",DRAWING:"DRAWING"},m={SUCCESS:null,INFO:"info",WARNING:"warning",ERROR:"error"},u=/\w+\.\w+$/,p=/ (Format|TileSize|Overlap|Width|Height)="?(\w+)/g,v=/\="?/,h=e=>e.match(p).map(e=>e.split(v)).map(([e,t])=>[e[1].toLowerCase()+e.slice(2),t]).reduce((e,[t,r])=>(e[t]="format"===t?r:parseInt(r,10),e),{}),f=e=>""===e||Boolean(e),w=e=>e?String(e):"",y=e=>e.replace(/-([a-z])/g,e=>e[1].toUpperCase()),b={400:"Bad Request",401:"Insufficient permissions",403:"Forbidden",404:"Not found",405:"Method not Allowed",406:"Not acceptable",408:"Request Timeout",500:"Internal Server error",501:"Not implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout"},_=e=>({message:`Image currently unavailable (${b[e.status]||e.status||"Unknown Error"}).`,response:e}),{KEYBOARD_LISTEN:O,PAN_ZOOM:E,ZOOM_MIN:x,ZOOM_MAX:A,PAN_DISABLED:I,ROTATE_DISABLED:R,ZOOM_DISABLED:M,DRAWING_ENABLED:T,ROTATE:k,IMAGE_INFO:z,IMAGE_MSG:N,IMAGE_INFO_ERROR:L,IMAGE_CURRENT:S,CREDENTIALS:D,SCROLLING_PARENT:P,TOOLS_CONTROL:C,LOCALE:j}=e,{INVERT:B,BRIGHTNESS:G,CONTRAST:H}=e.filters,{INFO:Y,WARNING:$,ERROR:Z}=m;var X=(e,{dispatch:t,getState:r},{zoomStep:a=1.2}={})=>{e.zoomIn=(()=>e.zoom*=a),e.zoomOut=(()=>e.zoom/=a);const o=(e,r)=>t({type:N,data:{text:e,type:r}});e.prompt=(e=>o(e,Y)),e.warn=(e=>o(e,$)),e.error=(e=>o(e,Z)),e.clearMessage=(()=>t({type:N,data:null})),e.gotoNextRow=(()=>{}),e.gotoPreviousRow=(()=>{});const i=()=>{const{src:a,credentials:o}=e;if(a&&o){let e=r().images[a];if(!e){e=(e=>{const t=e||"",[r,...a]=t.split("?");let o=a.join("&");if(o=o&&`?${o}`,!(e=>e?!e.match(/\.(jpg|jpeg|png|gif|tif|tiff|svg|bmp)$/):null)(r))return{query:o};const i=r.match(u)?r:`${r.replace(/\/$/,"")}/image.xml`,n=`${i.replace(/\.\w+$/,"")}_files`;return{dzi:i,tilePath:n,query:o}})(a);const{dzi:r,query:i}=e;if(r)((e,t="include")=>fetch(e,{credentials:t}).then(e=>e.ok?e.text().then(h):Promise.reject(e)))(r+i,o).then(r=>{t({type:z,data:Object.assign(r,e),image:a})}).catch(e=>{t({type:L,data:_(e),image:a})});else{const r=new Image;r.onload=(()=>{const{width:o,height:i}=r;t({type:z,data:Object.assign({width:o,height:i},e),image:a})}),r.onerror=(e=>{t({type:L,data:_(e),image:a})}),r.src=a}}}},n=e=>e,s=(e,t)=>({[t]:e}),l={},c=(e,a,o=n,i=n,s=(()=>r()[e]))=>{l[e]={get:s,set:r=>{t({type:a,data:o(r,e)}),i(r)}}};c("credentials",D,w,i),c("drawMode",T,f,t=>{t?e.setAttribute("draw-mode",""):e.removeAttribute("draw-mode")}),c("listeningToKeyboard",O,f),c("maxZoom",A),c("minZoom",x),c("noPan",I,f),c("noRotate",R,f),c("noZoom",M,f),c("panX",E,s),c("panY",E,s),c("src",S,w,i,()=>r().currentImage),c("zoom",E,s),c("scrollingParent",P,f),c("toolsControl",C,f),c("invert",B,f),c("brightness",G,Number),c("contrast",H,Number),c("locale",j,w),Object.defineProperties(e,l),Object.defineProperties(e,{columnCount:{configurable:!0,get:()=>1,set:e=>e},gridMode:{configurable:!0,get:()=>!1,set:e=>e},index:{configurable:!0,get:()=>0,set:e=>e},length:{configurable:!0,get:()=>e.src?1:0},nativeSize:{get:()=>{const e=r(),t=e.images[e.currentImage]||{},{width:a,height:o}=t;return{width:a,height:o}}},panZoom:{get:()=>{const{panX:e,panY:t,zoom:a}=r();return{panX:e,panY:t,zoom:a}},set:e=>{const{panX:r,panY:a,zoom:o}=e;t({type:E,data:{panX:r,panY:a,zoom:o}})}},rotation:{get:()=>180*r().rotation/Math.PI,set:e=>t({type:k,data:e*Math.PI/180})}})};const V=e=>(e^16*Math.random()>>e/4).toString(16),W=()=>"10000000-1000-4000-8000-100000000000".replace(/[018]/g,V),{overlays:{OVERLAYS:F,ADD:U,UPDATE:q,DELETE:K,selection:J,highlights:Q}}=e,ee=e=>{if(null==e.x)throw new Error('overlays must have an "x" property');if(null==e.y)throw new Error('overlays must have an "y" property');const t=e.id||W();return Object.assign({id:t},e)};const{markers:{MARKERS:te,ADD:re,UPDATE:ae,DELETE:oe}}=e,ie=e=>{const{node:t}=e;if(!(t instanceof Element))throw new Error('markers must must have a valid Element as their "node" property');const r=e.id||t.id||W();return t.id=r,Object.assign({id:r,node:t},e)};const{DRAWING_ENABLED:ne,KEYBOARD_LISTEN:se,PAN_ZOOM:le,ZOOM_MIN:ce,ZOOM_MAX:de,PAN_DISABLED:ge,ROTATE_DISABLED:me,ZOOM_DISABLED:ue,ROTATE:pe,IMAGE_INFO:ve,IMAGE_INFO_ERROR:he,IMAGE_MSG:fe,IMAGE_CURRENT:we,VIEW_SIZE:ye,IN_DOM:be,CREDENTIALS:_e,SCROLLING_PARENT:Oe,TOOLS_CONTROL:Ee,LOCALE:xe}=e,{INVERT:Ae,BRIGHTNESS:Ie,CONTRAST:Re}=e.filters,Me=2*Math.PI,Te={panX:.5,panY:.5,zoom:1,minZoom:.9,maxZoom:50,invert:!1,brightness:1,contrast:1,locale:"en",noZoom:!1,noPan:!1,noRotate:!1,scrollingParent:!1,rotation:0,inDom:!1,viewWidth:null,viewHeight:null,listeningToKeyboard:!1,drawMode:!1,currentImage:null,images:{},credentials:null,message:null,toolsControl:!1},ke=(e,t)=>{let{panX:r=t.panX,panY:a=t.panY,zoom:o=t.zoom}=e;return r=Math.min(Math.max(r,0),1),a=Math.min(Math.max(a,0),1),o=Math.min(Math.max(o,t.minZoom),t.maxZoom),{panX:r=isNaN(r)?t.panX:r,panY:a=isNaN(a)?t.panY:a,zoom:o=isNaN(o)?t.zoom:o}},ze=(e,t)=>{if(isNaN(e))return t;let r=e%Me;return r<0&&(r+=Me),r};var Ne=(e=Te,t)=>{if(!t)return e;const{type:r,data:a}=t,o=t=>Object.assign({},e,t),i=(e,t)=>{const r=isNaN(e)?Te[t]:e;return o({[t]:r})};switch(r){case le:{const{panX:t,panY:r,zoom:i}=ke(a,e);return t!==e.panX||r!==e.panY||i!==e.zoom?o({panX:t,panY:r,zoom:i}):e}case ce:{if(isNaN(a)||a>e.maxZoom)return e;const t=Number(a);return t===e.minZoom?e:o({minZoom:t,zoom:Math.max(e.zoom,t)})}case de:{if(isNaN(a)||a<e.minZoom)return e;const t=Number(a);return t===e.maxZoom?e:o({maxZoom:t,zoom:Math.min(e.zoom,t)})}case ue:return o({noZoom:Boolean(a)});case ge:return o({noPan:Boolean(a)});case me:return o({noRotate:Boolean(a)});case Oe:return o({scrollingParent:Boolean(a)});case pe:{const t=ze(a,e.rotation);return t!==e.rotation?o({rotation:t}):e}case Ae:return o({invert:Boolean(a)});case Ie:return i(a,"brightness");case Re:return i(a,"contrast");case be:return o({inDom:Boolean(a)});case ye:{const{viewWidth:t,viewHeight:r}=a;return t!==e.viewWidth||r!==e.viewHeight?o({viewWidth:t,viewHeight:r}):e}case se:{const t=Boolean(a);return e.listeningToKeyboard!==t?o({listeningToKeyboard:t}):e}case ne:{const t=Boolean(a);return e.drawMode!==t?o({drawMode:t}):e}case we:return e.currentImage!==a?o({currentImage:a}):e;case ve:{const{image:r}=t;return e.images[r]?e:o({images:Object.assign({},e.images,{[r]:a})})}case he:{const{image:r}=t;return e.images[r]?e:o({images:Object.assign({},e.images,{[r]:{error:a}})})}case fe:return o({message:a});case _e:return o({credentials:a});case Ee:return o({toolsControl:Boolean(a)});case xe:return o({locale:a});default:return e}};const Le=(e,t)=>t>e?[e,t-e]:[t,e-t],Se=(e,t)=>{const[r,a]=Le(e.imgX,t.imgX),[o,i]=Le(e.imgY,t.imgY);return{x:r,y:o,width:a,height:i}},De=(e,t,r)=>Math.min(Math.max(e,t),r),Pe=e=>(t,r)=>null==r?[De(t,0,1),r]:e(t,r),Ce=Pe((e,t)=>{const r=De(t,.01,1);return[De(e,0,1-r),r]}),je=Pe((e,t)=>{const r=De(e,0,e+t-.01);return[r,t+e-r]}),Be=Pe((e,t)=>[e,De(t,.01,1-e)]),Ge=(e,t)=>r=>{const[a,o]=e(r.x,r.width),[i,n]=t(r.y,r.height);return Object.assign({},r,{x:a,y:i,width:o,height:n})},He=Ge(Ce,Ce),{OVERLAYS:Ye,ADD:$e,UPDATE:Ze,DELETE:Xe}=e.overlays,{OBJECT:Ve}=d,We={overlays:Ve};var Fe=(e=We,t)=>{if(!t)return e;const{data:r}=t,a=t=>Object.assign({},e,t);switch(t.type){case Ye:{let e={},t=!1;return r.forEach(r=>{const{id:a}=r;a?e[a]?console.error(`Duplicate ID found when adding overlays: ${a}. Dropping duplicate`):(t=!0,e[a]=He(r)):console.error("Overlay was missing an ID property. Dropping.")}),t||(e=Ve),a({overlays:e})}case $e:{const{id:t}=r;if(!t)return console.error("Overlay was missing an ID property. Ignoring."),e;if(e.overlays[t])return console.error(`Duplicate ID found when adding overlays: ${t}. Ignoring duplicate`),e;const o=He(r);return a({overlays:Object.assign({},e.overlays,{[t]:o})})}case Ze:{const{id:t}=r;if(!e.overlays[t])return console.error(`Attempted to update a non-existent overlay with ID of ${t}.`),e;const o=He(Object.assign({},e.overlays[t],r));return a({overlays:Object.assign({},e.overlays,{[t]:o})})}case Xe:{if(!e.overlays[r])return e;const t=Object.assign({},e.overlays);return delete t[r],Object.keys(t).length?a({overlays:t}):a({overlays:Ve})}default:return e}};const{OBJECT:Ue}=d;var qe=(e,{ADD:t,REMOVE:r,CLEAR:a},o,i="__NOTHING__")=>{const n={[e]:Ue};return(s=n,l)=>{if(!l)return s;let{data:c}=l;const d=e=>Object.assign({},s,e);switch(l.type){case t:return"string"==typeof c&&(c=[c]),Array.isArray(c)?d({[e]:Object.assign({},s[e],c.reduce((e,t)=>(e[t]=!0,e),{}))}):s;case i:case r:{if("string"==typeof c&&(c=[c]),!Array.isArray(c)||s[e]===Ue)return s;let t=Object.assign({},s[e]);return Array.isArray(c)?c.forEach(e=>delete t[e]):delete t[c],Object.keys(t).length||(t=Ue),d({[e]:t})}case o:case a:return d({[e]:Ue});default:return s}}};const{highlights:Ke,OVERLAYS:Je,DELETE:Qe}=e.overlays;var et=qe("highlightedOverlays",Ke,Je,Qe);const{selection:tt,OVERLAYS:rt,DELETE:at}=e.overlays;var ot=qe("selectedOverlays",tt,rt,at);const{markers:{MARKERS:it,ADD:nt,UPDATE:st,DELETE:lt}}=e,{OBJECT:ct}=d,dt={markers:ct};var gt=(e=dt,t)=>{if(!t)return e;const{data:r}=t,a=t=>Object.assign({},e,{markers:t});switch(t.type){case it:{let e={},t=!1;return r.forEach(r=>{const{id:a}=r;a?e[a]?console.error(`Duplicate ID found when adding markermarkers: ${a}. Dropping duplicate`):(t=!0,e[a]=Object.assign({},r)):console.error("Marker was missing an ID property. Dropping.")}),t||(e=ct),a(e)}case nt:{const{id:t}=r;if(!t)return console.error("Marker was missing an ID property. Ignoring."),e;if(e.markers[t])return console.error(`Attempted to add a marker using an already-existing ID of${t}.`),e;const o=Object.assign({},r,{id:t});return a(Object.assign({},e.markers,{[t]:o}))}case st:{const{id:t}=r;if(!e.markers[t])return console.error(`Attempted to update a non-existent marker with ID of ${t}.`),e;const o=Object.assign({},e.markers[t],r);return a(Object.assign({},e.markers,{[t]:o}))}case lt:{if(!e.markers[r])return e;const t=Object.assign({},e.markers);return delete t[r],Object.keys(t).length?a(t):a(ct)}default:return e}};const{POINT_DOWN:mt,POINT_UP:ut,POINT_MOVE:pt}=e.user,vt=e.overlays.DELETE,{PANNING:ht,RESIZING:ft,MOVING:wt,DRAWING:yt}=g,{OBJECT:bt}=d,_t=Math.PI/2,Ot=Math.PI/32,Et={startPoint:null,currentPoint:null,behavior:null,currentHoveredOverlay:null,currentHandle:null},xt=(e,t,r,a,o)=>{o?(e[r]+=t,e[a]-=t):e[a]+=t};var At=(e=Et,t)=>{if(!t)return e;const{type:r,data:a}=t,o=(...t)=>Object.assign({},e,...t),{startPoint:i,currentPoint:n,overlays:s,gridMode:l}=e;switch(r){case mt:{const{id:t}=a;let{currentHandle:r}=e;return t&&"__overlay-resize-handle"===t.substr(0,"__overlay-resize-handle".length)&&(r=t),o({startPoint:a,currentHandle:r})}case ut:{if(!i)return e;const{behavior:t,dragHappened:r}=e;let{selectedOverlays:a,rotation:n,currentImage:c}=e;if(r){if(t===ht){const t=e.rotation%_t;(t<Ot||t>_t-Ot)&&(n=Math.round(e.rotation/_t)*_t)}}else{const{id:e,src:t}=i;l&&t?c=t:a=e&&s[e]&&s[e].selectable?{[e]:!0}:bt}return o({startPoint:null,currentPoint:null,currentHandle:null,behavior:null,dragHappened:!1,selectedOverlays:a,rotation:n,currentImage:c})}case vt:return a===e.currentHoveredOverlay?o({currentHoveredOverlay:null}):e;case pt:{if(!i&&!l){const t=e.currentHoveredOverlay;let{id:r}=a;return e.overlays[r]||(r=null),t===r?e:o({currentHoveredOverlay:r})}if(l)return e;const t=n||i,r={x:a.imgX-t.imgX,y:a.imgY-t.imgY},c=e.dragHappened||((e,t)=>Math.abs(e.viewX-t.viewX)>2||Math.abs(e.viewY-t.viewY)>2||e.rotation!==t.rotation)(t,i),{id:d}=a,{selectedOverlays:g,currentHandle:m,drawMode:u}=e;let{behavior:p}=e;p||(p=m?ft:d&&g[d]?wt:u?yt:ht);const v={currentPoint:a,dragHappened:c,behavior:p};switch(p){case wt:{const e=Object.assign({},s);return Object.keys(g).forEach(t=>{const a=Object.assign({},s[t]);a.x+=r.x,a.y+=r.y,e[t]=He(a)}),v.overlays=e,o(v)}case yt:return o(v);case ft:{const e=Object.assign({},s);return Object.keys(g).forEach(t=>{const a=Object.assign({},s[t]),o=Boolean(m.match("LEFT")),i=Boolean(m.match("TOP"));xt(a,r.x,"x","width",o),xt(a,r.y,"y","height",i),e[t]=((e,t,r)=>{return Ge(r?je:Be,t?je:Be)(e)})(a,i,o)}),v.overlays=e,o(v)}case ht:{const i=Object.assign({},a),{noPan:n,noZoom:s,noRotate:l}=e;n&&(r.x=0,r.y=0),i.imgX=t.imgX,i.imgY=t.imgY,v.currentPoint=i;const c={panX:e.panX-r.x,panY:e.panY-r.y};if(a.distance&&!s){const r=a.distance/t.distance;c.zoom=e.zoom*r}if(a.rotation&&!l){const r=a.rotation-t.rotation;v.rotation=ze(e.rotation+r,e.rotation)}return o(v,ke(c,e))}default:return e}}default:return e}};const It=Object.prototype.hasOwnProperty;function Rt(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}const Mt=new Set,Tt=()=>{Mt.forEach(e=>e()),Mt.size&&requestAnimationFrame(()=>Tt())};var kt=e=>{const t=[];let r=null;const a=()=>{const a=e();if(r!==a){const e=r;r=a,t.forEach(t=>{const{selector:a,onUpdate:o,state:i,isEqual:n}=t,s=a(r,e);n(i,s)||(t.state=s,o(s))})}};a(),(e=>{Mt.add(e),1===Mt.size&&Tt()})(a);const o=(e,a,o=((e,t)=>{if(Rt(e,t))return!0;if(function(e,t){return"object"!=typeof e||null===e||"object"!=typeof t||null===t}(e,t))return!1;const r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(let a=0;a<r.length;a++)if(!It.call(t,r[a])||!Rt(e[r[a]],t[r[a]]))return!1;return!0}))=>{const i=e(r,r);a(i),t.push({selector:e,onUpdate:a,state:i,isEqual:o})};return o.clear=(()=>(e=>Mt.delete(e))(a)),o};function zt(e,...t){const r=t.reduce((t,r,a)=>t+r+e[a+1],e[0]),a=document.createElement("div");return a.innerHTML=r,a.firstElementChild}const Nt=zt`<style component="fs-single-image-viewer">
fs-single-image-viewer {
  --color-place: #FCB34B;
  --color-date: #27C4F4;
  --color-generic: #F16458;
  --color-name: #87B940;
  --handle-size: 18px;
  --handle-color: var(--color-name);
  --thickness: 3px;
  display: block;
  position: relative;
  background: #888;
  flex-grow: 1;
  user-select: none;
  -ms-user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
}

fs-single-image-viewer > * {
  overflow: hidden;
  position: absolute;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

/* make the handles big on mobile devices */
@media screen and (pointer: coarse) {
  fs-single-image-viewer {
    --handle-size: 34px;
  }
}

fs-single-image-viewer *[inactive] {
  opacity: 0;
  pointer-events: none !important;
}

fs-single-image-viewer[draw-mode] {
  cursor: crosshair;
}

fs-single-image-viewer[draw-mode] * {
  pointer-events: none !important;
}

.fs-image-viewer__stage {
  position: absolute;
  transform-origin: top left;
}

.fs-image-viewer__stage > * {
  box-sizing: border-box;
}

.fs-image-viewer__level {
  width: 100%;
  height: 100%;
}

.fs-image-viewer__stage img {
  display: block;
  position: absolute;
}

.fs-image-viewer__image,
.fs-image-viewer__overlays {
  display: block;
  position: absolute;
  width: 100%;
  height: 100%;
}

.fs-image-viewer__markers {
  overflow: initial;
}

.fs-image-viewer__markers > *,
.fs-image-viewer__overlays > * {
  position: absolute;
  transition: opacity 0.3s;
}

fs-single-image-viewer *[interactive],
.fs-image-viewer__overlays > * {
  pointer-events: auto;
}


.fs-image-viewer__drag-rectangle {
  position: absolute;
  top: 0;
  left: 0;
  border: 1px solid rgba(75, 150, 75, 0.5);
  background: rgba(75, 150, 75, 0.25);
}

.fs-image-viewer__overlay {
  cursor: pointer;
  z-index: 1;
  opacity: 0.35;
}

.fs-image-viewer__overlay[type] {
  background: var(--color-generic);
}

.fs-image-viewer__overlay[type="name"] {
  background: var(--color-name);
}

.fs-image-viewer__overlay[type="place"] {
  background: var(--color-place);
}

.fs-image-viewer__overlay[type="date"] {
  background: var(--color-date);
}

.fs-image-viewer__overlay[selected] {
  z-index: 5;
  background: transparent;
  cursor: move;
}

.fs-image-viewer__overlay-rects > * {
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
  border-radius: calc(var(--thickness)/2);
  box-shadow: 0 0 0 var(--thickness) #fff,
              calc(var(--thickness)/2) calc(var(--thickness)/2) calc(var(--thickness)*2) var(--thickness) rgba(0,0,0,0.45);
  transition: opacity 0.3s;
}

.fs-image-viewer__overlay-mask {
  opacity: 0.25;
  width: 100%;
  height: 100%;
  transition: opacity 0.3s;
  position: absolute;
}

.fs-image-viewer__overlay-mask > * {
  background: #000;
  position: absolute;
}

.fs-image-viewer__overlay-handles {
  position: absolute;
}

.fs-image-viewer__overlay-handles > * {
  position: absolute;
  border-radius: 100%;
  box-sizing: border-box;
  width: var(--handle-size);
  height: var(--handle-size);
  background-color: var(--handle-color, var(--color-name));
  border: 2px solid #fff;
  box-shadow: 2px 2px 2px rgba(0,0,0,0.5);
  top: calc(-.5 * var(--handle-size));
  left: calc(-.5 * var(--handle-size));
  cursor: nesw-resize;
  pointer-events: auto;
}

.fs-image-viewer__overlay-handles > *:nth-child(2n) {
  cursor: nwse-resize;
}

.fs-image-viewer__overlay-handles > *:not(:last-child) {
  display: none;
}

*[all-the-handles] .fs-image-viewer__overlay-handles > * {
  display: block;
}

.fs-image-viewer__message {
  position: absolute;
  top: 20px;
  left: 70px;
  width: calc(100% - 90px);
  box-sizing: border-box;
  display: flex;
  justify-content: center;
}

.fs-image-viewer__message .fs-alert {
  flex-basis: 500px;
  box-shadow: 3px 3px 5px rgba(0, 0, 0, 0.25);
}
</style>`,Lt={de:{zoomIn:"Vergrößern",zoomOut:"Verkleinern",tools:"Hilfsmittel",rotateLeft:"Nach links drehen",rotateRight:"Nach rechts drehen",invert:"Umkehren",adjustImage:"Aufnahme anpassen"},en:{zoomIn:"Zoom in",zoomOut:"Zoom out",tools:"Tools",rotateLeft:"Rotate left",rotateRight:"Rotate Right",invert:"Invert",adjustImage:"Adjust Image"},es:{zoomIn:"Ampliar",zoomOut:"Reducir",tools:"Herramientas",rotateLeft:"Girar a la izquierda",rotateRight:"Girar a la derecha",invert:"Invertir",adjustImage:"Ajustar imagen"},eo:{zoomIn:"[Žööɱ Îñ------- П國カ내]",zoomOut:"[Žööɱ Öûţ--------- П國カ내]",tools:"[Tools----------]",rotateLeft:"[Rotate left---------]",rotateRight:"[Rotate Right---------]",invert:"[Invert------------]",adjustImage:"[Adjust Image----------]"},fr:{zoomIn:"Zoom avant",zoomOut:"Zoom arrière",tools:"Outils",rotateLeft:"Rotation à gauche",rotateRight:"Rotation à droite",invert:"Inverser",adjustImage:"Régler l’image"},it:{zoomIn:"Ingrandisci",zoomOut:"Rimpicciolisci",tools:"Strumenti",rotateLeft:"Ruota a sinistra",rotateRight:"Ruota a destra",invert:"Inverti",adjustImage:"Regola immagine"},ja:{zoomIn:"拡大",zoomOut:"縮小",tools:"ツール",rotateLeft:"左に回転する",rotateRight:"右に回転する",invert:"反転",adjustImage:"画像の調整"},ko:{zoomIn:"화면 확대",zoomOut:"화면 축소",tools:"도구",rotateLeft:"왼쪽으로 회전",rotateRight:"오른쪽으로 회전",invert:"방향 전환",adjustImage:"이미지 조절"},pt:{zoomIn:"Aproximar",zoomOut:"Afastar",tools:"Ferramentas",rotateLeft:"Girar para a esquerda",rotateRight:"Girar para a direita",invert:"Inverter",adjustImage:"Ajuste de Imagem"},ru:{zoomIn:"Приблизить",zoomOut:"Отдалить",tools:"Инструменты",rotateLeft:"Повернуть влево",rotateRight:"Повернуть вправо",invert:"Инвертировать",adjustImage:"Обработать снимок"},zh:{zoomIn:"放大",zoomOut:"縮小",tools:"工具",rotateLeft:"向左旋轉",rotateRight:"向右旋轉",invert:"反轉",adjustImage:"調整影像"}};var St=(e,t)=>{let r;"function"==typeof e.getRootNode&&(r=e.getRootNode())!==document&&r!==e||(r=document.head);const a=`style[component="${t.getAttribute("component")}"]`;r.querySelector(a)||r.insertBefore(t.cloneNode(!0),r.firstChild)};const Dt=(e,t)=>t.map(t=>{const r=y(t);return void 0!==e[r]?e[r]:e.getAttribute(t)}),Pt=(e,t)=>t.map(t=>e.querySelector(t)),Ct={de:{brightness:"Helligkeit",contrast:"Kontrast",apply:"Übernehmen",cancel:"Abbrechen"},en:{brightness:"Brightness",contrast:"Contrast",apply:"Apply",cancel:"Cancel"},es:{brightness:"Brillo",contrast:"Contraste",apply:"Aplicar",cancel:"Cancelar"},eo:{brightness:"[Brightness------]",contrast:"[Contrast----------]",apply:"[Apply-------------]",cancel:"[Cancel----------]"},fr:{brightness:"Luminosité",contrast:"Contraste",apply:"Appliquer",cancel:"Annuler"},it:{brightness:"Luminosità",contrast:"Contrasto",apply:"Applica",cancel:"Annulla"},ja:{brightness:"明度",contrast:"コントラスト",apply:"適応",cancel:"キャンセル"},ko:{brightness:"밝기",contrast:"대비",apply:"적용",cancel:"취소"},pt:{brightness:"Brilho",contrast:"Contraste",apply:"Aplicar",cancel:"Cancelar"},ru:{brightness:"Яркость",contrast:"Контраст",apply:"Применить",cancel:"Отменить"},zh:{brightness:"亮度",contrast:"對比",apply:"套用",cancel:"取消"}};var jt=(e,t)=>{const r=zt`
  <div class="fs-image-viewer__adjustments" interactive>
    <label>${Ct[t].brightness}</label>
    <div class="fs-image-viewer__slider" type="brightness">
      <input type="range" step="any" min="0" max="2"/>
    </div>
    <label>${Ct[t].contrast}</label>
    <div class="fs-image-viewer__slider" type="contrast">
      <input type="range" step="any" min="0" max="2"/>
    </div>
    <div class="fs-image-viewer__adjust-buttons">
      <button type="apply">${Ct[t].apply}</button>
      <button type="cancel">${Ct[t].cancel}</button>
    </div>
  </div>
`,a={brightness:e.brightness,contrast:e.contrast},o=e.querySelector(".fs-image-viewer__adjustments");o&&o.remove();const i=r.cloneNode(!0);return i.querySelectorAll(".fs-image-viewer__slider").forEach(t=>{const r=t.firstElementChild,o=t.getAttribute("type");r.value=e[o],r.cancel=(()=>{r.value=a[o]}),r.oninput=(()=>{e[o]=r.value}),t.onclick=(a=>{const{target:i,offsetX:n}=a;if(i!==t)return;let s=Number(r.value);n<i.clientWidth/2?s-=.3:s+=.3,r.value=s,e[o]=r.value})}),i.querySelector('[type="apply"]').onclick=(()=>{a.brightness=e.brightness,a.contrast=e.contrast,i.remove()}),i.querySelector('[type="cancel"]').onclick=(()=>{i.querySelectorAll("input").forEach(e=>e.cancel()),e.brightness=a.brightness,e.contrast=a.contrast,i.remove()}),e.appendChild(i)};const Bt=zt`<style component="fs-image-viewer-control">
.fs-image-viewer__controls {
  pointer-events: auto;
  cursor: pointer;
  top: 25px;
  left: 25px;
  z-index: 100;
  opacity: .8;
  width: 38px;
  display: flex;
  flex-direction: column;
  position: absolute;
}

fs-image-viewer-control > .fs-image-viewer__controls {
  pointer-events: none;
  opacity: 0;
  top: 0;
  left: 45px;
}

fs-image-viewer-control[open] > .fs-image-viewer__controls {
  pointer-events: auto;
  opacity: 1;
}

fs-image-viewer-control {
  position: relative;
  background-position: center;
  background-repeat: no-repeat;
  height: 35px;
  background-color: #000;
  border-left: 1px solid #000;
  border-right: 1px solid #000;
  transition: background-color .35s;
}

fs-image-viewer-control[open], fs-image-viewer-control:hover {
  background-color: #777;
}

fs-image-viewer-control:first-of-type {
  border-top: 1px solid #000;
  border-top-left-radius: 4px;
  border-top-right-radius: 4px;
}

fs-image-viewer-control:last-of-type {
  border-bottom: 1px solid #000;
  border-bottom-left-radius: 4px;
  border-bottom-right-radius: 4px;
}

fs-image-viewer-control.zoom-in {
  background-image: url('data:image/svg+xml,<svg viewBox="0 0 38 35" xmlns="http://www.w3.org/2000/svg"><path d="M19.5 11v14M26.5 18h-14" stroke="white" stroke-width="4"/></svg>');
}

fs-image-viewer-control.zoom-out {
  background-image: url('data:image/svg+xml,<svg viewBox="0 0 38 35" xmlns="http://www.w3.org/2000/svg"><path d="M26.5 18h-14" stroke="white" stroke-width="4"/></svg>');
}

fs-image-viewer-control.tools {
  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="23" height="17"><path fill="white" d="M20.8 15.9c-.3.6-1.1 1.1-1.7 1.1H3.9c-.6 0-1.4-.5-1.7-1.1a17.7 17.7 0 0 1 0-14.6C2.5.7 3.3 0 3.9 0h15.2c.6 0 1.4.7 1.7 1.3 2.1 4.6 2.1 9.9 0 14.6z"/><path fill="none" stroke="black" stroke-width="2.2" stroke-linecap="round" d="M4.6 5h1.6m6 0h6.3M9.1 2.9c-1.4 0-2.6.9-2.6 2.1s1.2 2.1 2.6 2.1 2.6-.9 2.6-2.1-1.2-2.1-2.6-2.1zm9.3 9.1h-1.7m-5.9 0H4.4m9.5 2.1c1.4 0 2.6-.9 2.6-2.1s-1.2-2.1-2.6-2.1-2.6.9-2.6 2.1 1.2 2.1 2.6 2.1z"/></svg>');
}

fs-image-viewer-control.rotate-left,
fs-image-viewer-control.rotate-right {
  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="17" height="19"><path fill="white" d="M16 17H6c0-2-3-7 4-8l1 3 5-8-9-3 1 3c-9 4-5 11-3 13H1l-1 1 1 1h15a1 1 0 0 0 0-2z"/></svg>');
}

fs-image-viewer-control.rotate-left {
  transform: scaleX(-1);
}
fs-image-viewer-control.rotate-left > div {
  transform: scaleX(-1);
  left: -81px;
}

fs-image-viewer-control.adjust-image {
  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="29" height="19"><path fill="white" d="M25.4 13c.8 0 1.5.7 1.5 1.5 0 .9-.7 1.5-1.5 1.5s-3.6-.5-3.6-1.5 2.8-1.5 3.6-1.5zm-5.9-4c.8.8 3-.8 3.6-1.4s.6-1.6 0-2.2c-.6-.6-1.6-.6-2.2 0-.5.5-2.2 2.8-1.4 3.6zM14 6.7c1.1 0 1.5-2.7 1.5-3.6s-.7-1.5-1.5-1.5c-.9 0-1.5.7-1.5 1.5s.4 3.6 1.5 3.6zM8.5 9c.7-.8-.9-3-1.5-3.6s-1.6-.6-2.2 0-.5 1.6.1 2.2S7.7 9.8 8.5 9zm-2.3 5.5c0-1.1-2.7-1.5-3.6-1.5-.8 0-1.5.7-1.5 1.5S1.8 16 2.6 16s3.6-.4 3.6-1.5z"/><path fill="none" stroke="white" stroke-width="2" d="M19.5,15h-11v-0.5c0-3,2.4-5.5,5.5-5.5 s5.5,2.4,5.5,5.5V15z"/></svg>');
}
  
fs-image-viewer-control.invert {
  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="17" height="19"><path fill="white" d="M16 5l-4-4-2-1H1L0 1v17l1 1h15l1-1V7l-1-2zm-3 12L2 4V2h7l1 1v3l1 1h3l1 1v9h-2z"/></svg>');
}

.fs-image-viewer-control__tooltip {
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.5s;
  width: 80px;
  background: #000;
  color: #fff;
  text-align: center;
  padding: 6px;
  border-radius: 3px;
  position: absolute;
  top: 5px;
  left: 50px;
  font-size: 75%;
  line-height: 1.3;
}

.fs-image-viewer-control__tooltip::after {
  content: '';
  display: block;
  position: absolute;
  left: -5px;
  width: 10px;
  height: 10px;
  transform: rotate(45deg);
  background: #000;
  top: 50%;
  margin-top: -5px;
}

fs-image-viewer-control:hover > .fs-image-viewer-control__tooltip {
  opacity: 1;
  transition-delay: 0.5s;
}

fs-image-viewer-control[open] > .fs-image-viewer-control__tooltip {
  opacity: 0;
}

.fs-image-viewer__adjustments {
  z-index: 200;
  color: #fff;
  opacity: 0.8;
  background-color: #000;
  text-align: center;
  width: 250px;
  height: 155px;
  padding: 20px 30px;
  position: absolute;
  left: 50%;
  top: 50%; 
  margin-left: -125px;
  margin-top: -77px;
}
.fs-image-viewer__adjustments label {
  display: block;
  color: #fff;
}
.fs-image-viewer__adjust-button,
.fs-image-viewer__slider::before,
.fs-image-viewer__slider::after,
.fs-image-viewer__adjust-buttons button::before {
  display: inline-block;
  width: 33px;
  height: 33px;
  background-repeat: no-repeat;
  background-size: 33px 33px;
}
.fs-image-viewer__slider {
  display: flex;
  align-items: center;
  width: 100%;
}
.fs-image-viewer__slider input[type=range] {
  flex-grow: 1;
  background: transparent;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
}
.fs-image-viewer__slider input[type=range]:focus {
  outline: 0;
}
.fs-image-viewer__slider input[type=range]::-webkit-slider-runnable-track {
  box-sizing: border-box;
  height: 18px;
  cursor: pointer;
  background: #fff;
  border: 7px solid #000;
  border-radius: 13px;
}
.fs-image-viewer__slider input[type=range]::-moz-range-track {
  box-sizing: border-box;
  height: 18px;
  cursor: pointer;
  background: #fff;
  border: 7px solid #000;
  border-radius: 13px;
}
.fs-image-viewer__slider input[type=range]::-ms-track {
  box-sizing: border-box;
  height: 18px;
  cursor: pointer;
  background: #fff;
  border: 7px solid #000;
  border-radius: 13px;
}
.fs-image-viewer__slider input[type=range]::-webkit-slider-thumb {
  box-sizing: border-box;
  height: 22px;
  border: 1px solid #d3d3d3;
  width: 9px;
  border-radius: 3px;
  background: #fff;
  cursor: pointer;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  margin-top: -9px;
}
.fs-image-viewer__slider input[type=range]::-moz-range-thumb {
  box-sizing: border-box;
  height: 22px;
  border: 1px solid #d3d3d3;
  width: 9px;
  border-radius: 3px;
  background: #fff;
  cursor: pointer;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  margin-top: -9px;
}
.fs-image-viewer__slider input[type=range]::-ms-thumb {
  box-sizing: border-box;
  height: 22px;
  border: 1px solid #d3d3d3;
  width: 9px;
  border-radius: 3px;
  background: #fff;
  cursor: pointer;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  margin-top: -9px;
  margin-top: 0;
}
.fs-image-viewer__slider::before,
.fs-image-viewer__slider::after {
  content: '';
  cursor: pointer;
}
.fs-image-viewer__slider[type=brightness]::before {
  background-image: url('data:image/svg+xml,<svg viewBox="0 0 33 33" xmlns="http://www.w3.org/2000/svg"><circle cx="16.5" cy="16.5" r="4" stroke="white" stroke-width="2"/><path fill="white" d="M15.6 8L15 5.5a1.6 1.6 0 1 1 3 0L17.4 8a1 1 0 0 1-1.8 0zM10 11.1L7.7 9.8a1.5 1.5 0 1 1 2-2.1l1.4 2.2A.9.9 0 0 1 10 11zM8 17.4l-2.5.6a1.5 1.5 0 1 1 0-3l2.5.6a.9.9 0 0 1 0 1.8zm3.1 5.7l-1.3 2.2a1.5 1.5 0 1 1-2.1-2l2.2-1.4A.9.9 0 0 1 11 23zm6.3 1.9l.6 2.5a1.6 1.6 0 1 1-3 0l.6-2.5a1 1 0 0 1 1.8 0zm5.7-3.1l2.2 1.3a1.6 1.6 0 1 1-2 2.1l-1.4-2.2A.9.9 0 0 1 23 22zm1.9-6.3l2.5-.6a1.6 1.6 0 1 1 0 3l-2.5-.6a.9.9 0 0 1 0-1.8zM21.9 10l1.3-2.2a1.6 1.6 0 1 1 2.1 2l-2.2 1.4A.9.9 0 0 1 22 10z"/></svg>');
}
.fs-image-viewer__slider[type=brightness]::after {
  background-image: url('data:image/svg+xml,<svg viewBox="0 0 33 33" xmlns="http://www.w3.org/2000/svg"><g fill="white"><path d="M15.6 6.5l-.6-4a1.5 1.5 0 1 1 3 0l-.6 4a.9.9 0 0 1-1.8 0zm-6.8 3.6L5.5 7.7a1.5 1.5 0 1 1 2.2-2.2L10 8.8a.9.9 0 0 1-1.3 1.3zm-2.3 7.3l-4 .6a1.5 1.5 0 1 1 0-3l4 .6a.9.9 0 0 1 0 1.8zm3.6 6.8l-2.4 3.3a1.5 1.5 0 1 1-2.2-2.2L8.8 23a.9.9 0 0 1 1.2 1.3zm7.3 2.3l.6 4a1.5 1.5 0 1 1-3 0l.6-4a.9.9 0 0 1 1.8 0zm6.8-3.6l3.3 2.4a1.5 1.5 0 1 1-2.2 2.2L23 24.2a.9.9 0 0 1 1.3-1.2zm2.3-7.3l4-.6a1.5 1.5 0 1 1 0 3l-4-.6a.9.9 0 0 1 0-1.8zm-3.6-6.8l2.4-3.3a1.5 1.5 0 1 1 2.2 2.2L24.2 10A.9.9 0 0 1 23 8.8z"/><circle cx="16.5" cy="16.5" r="4.5"/></g><circle cx="16.5" cy="16.5" r="7" stroke="white" fill="none"/></svg>');
}
.fs-image-viewer__slider[type=contrast]::before {
  background-image: url("data:image/svg+xml,<svg viewBox='0 0 33 33' xmlns='http://www.w3.org/2000/svg'><circle cx='16.5' cy='16.5' r='8' stroke='white' fill='gray' stroke-width='2'/></svg>");
}
.fs-image-viewer__slider[type=contrast]::after {
  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 33 33"><path fill="white" d="M16.5 7.5c-5 0-9 4-9 9s4 9 9 9 9-4 9-9-4-9-9-9zm0 16v-14a7 7 0 0 1 7 7 7 7 0 0 1-7 7z"/></svg>');
}
.fs-image-viewer__adjust-buttons {
  display: flex;
  justify-content: center;
  align-content: space-between;
  padding-top: 10px;
}
.fs-image-viewer__adjust-buttons button {
  background: transparent;
  color: #fff;
  border: 0;
  cursor: pointer;
  display: flex;
  align-items: center;
  font-size: 1em;
}
.fs-image-viewer__adjust-buttons button::before {
  content: '';
}
.fs-image-viewer__adjust-buttons button:focus {
  outline: none;
}
.fs-image-viewer__adjust-buttons button[type=apply]::before {
  background-image: url("data:image/svg+xml,<svg viewBox='0 0 33 33' xmlns='http://www.w3.org/2000/svg'><path d='M14.2 24.8a1 1 0 0 1-1.4 0l-7-7a1 1 0 0 1 0-1.5l2.5-2.6a1 1 0 0 1 1.4 0l3 3c.5.5 1.1.5 1.5 0l9-9a1 1 0 0 1 1.5 0l2.6 2.6c.4.4.4 1 0 1.4l-13 13z' fill='white'/></svg>");
}
.fs-image-viewer__adjust-buttons button[type=cancel]::before {
  background-image: url("data:image/svg+xml,<svg viewBox='0 0 33 33' xmlns='http://www.w3.org/2000/svg' fill='white'><path d='M11.7 25.3a1 1 0 0 1-1.4 0l-2.6-2.6a1 1 0 0 1 0-1.4L21.3 7.7a1 1 0 0 1 1.4 0l2.6 2.6c.4.4.4 1 0 1.4L11.7 25.3z'/><path d='M25.3 21.3c.4.4.4 1 0 1.4l-2.6 2.6a1 1 0 0 1-1.4 0L7.7 11.7a1 1 0 0 1 0-1.4l2.6-2.6a1 1 0 0 1 1.4 0l13.6 13.6z'/></svg>");
}
</style>`,Gt="fs-image-viewer-control";customElements.get(Gt)||customElements.define(Gt,class extends HTMLElement{constructor(){let e,t;super(),Object.defineProperties(this,{alt:{get:()=>e,set:t=>{e=t,this.updateAlt()}},icon:{get:()=>t,set:e=>{t=e,this.updateIcon()}}})}connectedCallback(){setTimeout(()=>{St(this,Bt);const e=Array.from(this.querySelectorAll("fs-image-viewer-control"));if(this.innerHTML=`<div class="${Gt}__tooltip"></div>`,e.length){const t=document.createElement("div");t.className="fs-image-viewer__controls",e.forEach(e=>t.appendChild(e)),this.appendChild(t),this.addEventListener("click",e=>{e.target===this&&(null!==this.getAttribute("open")?this.removeAttribute("open"):this.setAttribute("open",""))})}this.updateAlt(),this.updateIcon()},0)}static get observedAttributes(){return["alt","icon"]}attributeChangedCallback(e,t,r){this[e]=r}updateAlt(){this.children.length&&(this.children[0].textContent=this.alt)}updateIcon(){this.style.backgroundImage=this.icon?`url('${this.icon}')`:null}});const{TOP_LEFT:Ht,TOP_RIGHT:Yt,BOTTOM_LEFT:$t,BOTTOM_RIGHT:Zt}={TOP_LEFT:"__overlay-resize-handle-TOP-LEFT__",TOP_RIGHT:"__overlay-resize-handle-TOP-RIGHT__",BOTTOM_LEFT:"__overlay-resize-handle-BOTTOM-LEFT__",BOTTOM_RIGHT:"__overlay-resize-handle-BOTTOM-RIGHT__"},Xt=zt`
<div class="fs-image-viewer">
  <div><div class="fs-image-viewer__stage">
    <div class="fs-image-viewer__image"></div>
    <div class="fs-image-viewer__overlays" inactive></div>
    <div class="fs-image-viewer__overlay-mask" inactive><div></div><div></div><div></div><div></div></div>
    <div class="fs-image-viewer__drag-rectangle" inactive></div>
  </div></div>
  <div class="fs-image-viewer__markers" inactive></div>
  <div>
    <div class="fs-image-viewer__overlay-rects"></div>
    <div class="fs-image-viewer__overlay-handles" inactive>
      <div id="${Yt}"></div>
      <div id="${Ht}"></div>
      <div id="${$t}"></div>
      <div id="${Zt}"></div>
    </div>
    <div class="fs-image-viewer__controls" interactive>
      <fs-image-viewer-control class="zoom-in"></fs-image-viewer-control>
      <fs-image-viewer-control class="zoom-out"></fs-image-viewer-control>
      <div class="zoomInsertionPoint"></div>
      <div class="toolsInsertionPoint"></div>
      <fs-image-viewer-control class="tools" no-close>
        <fs-image-viewer-control no-close class="rotate-left"></fs-image-viewer-control>
        <fs-image-viewer-control no-close class="rotate-right"></fs-image-viewer-control>
        <fs-image-viewer-control class="invert"></fs-image-viewer-control>
        <fs-image-viewer-control class="adjust-image"></fs-image-viewer-control>
      </fs-image-viewer-control>
    </div>
    <div class="fs-image-viewer__message" inactive><div class="fs-alert"><p>--message--</p></div></div>
  </div>
</div>
`,Vt=(e,t,r,a,o)=>{const[i,n,s,l]=[t,r,a,o].map(e=>`${100*e}%`);Object.assign(e.style,{left:i,top:n,width:s,height:l})};var Wt=(e,t)=>{let r=null,a=null,o=!1;const i=Xt.cloneNode(!0),n={},s={},l={};let c=null,d=!1,g="en";const[m,u,p,v,h,w,y,b,O,E,x]=(e=>Pt(i,e.map(e=>`.fs-image-viewer__${e}`)))(["markers","stage","image","overlays","overlay-mask","overlay-rects","overlay-handles","drag-rectangle","controls","message","message p"]),[A,I,R,M]=Pt(y,[`#${Yt}`,`#${Ht}`,`#${$t}`,`#${Zt}`]),[T,k,z,N,L]=Array.from(O.children),[S,D,P,C]=Array.from(L.querySelectorAll("fs-image-viewer-control")),[j,B,G,H]=Array.from(h.children),Y=E.children[0],$=[],Z=[],X=e=>e.removeAttribute("inactive"),V=(e,t)=>{u.style.width=`${e}px`,u.style.height=`${t}px`},W=()=>{if(!c)return;const{xmin:e,ymin:r,xmax:a,ymax:o}=c,i=t();if(i){const t=(e,t,r)=>{const a=i.toPixels(t,r);e.style.transform=`translate(${a.x}px, ${a.y}px)`};t(I,e,r),t(A,a,r),t(R,e,o),t(M,a,o)}},F=t=>{t&&Object.keys(l).map(e=>l[e]).filter(e=>e).forEach(r=>{let a,o,i=!1;const l=r.node;if(null!=r.x)({x:a,y:o}=r);else{const{followOverlayId:e,followOverlayPosition:t,hideWhenInactive:l}=r;let c=n[e];if("__ACTIVE__"===e){const e=Object.keys(s);c=n[e[0]]}if(!c||l&&!s[e])e&&(i=!0);else{const e=t||"";({x:a,y:o}=c.overlay);const{width:r,height:i}=c.overlay;e.match("right")?a+=r:e.match("left")||(a+=r/2),e.match("bottom")?o+=i:e.match("top")||(o+=i/2)}}({x:a,y:o}=t.toPixels(a,o)),null!=a&&(l.style.transform=`translate(${a}px, ${o}px)`),(a<0||o<0||a>e.clientWidth||o>e.clientHeight)&&(i=!0),i?l.setAttribute("inactive",""):X(l)})},U=e=>{if(1===e.length){X(h);const{overlay:t}=n[e[0]];Vt(G,0,0,t.x,1),Vt(H,t.x+t.width,0,1-t.x-t.width,1),Vt(j,0,0,1,t.y),Vt(B,0,t.y+t.height,1,1-t.y-t.height)}else h.setAttribute("inactive","")},q=()=>{T.alt=Lt[g].zoomIn,k.alt=Lt[g].zoomOut,S.alt=Lt[g].rotateLeft,D.alt=Lt[g].rotateRight,window.navigator.userAgent.match(/iPad/i)||window.navigator.userAgent.match(/iPhone/i)||(P.alt=Lt[g].invert,C.alt=Lt[g].adjustImage),L.alt=Lt[g].tools};return{initialize(){var t;o||(St(e,Nt),Array.from(e.children).forEach(e=>{const t=e.getAttribute("slot");"marker"===t?$.push((e=>{const[t,r]=Dt(e,["x","y"]).map(e=>null==e?null:Number(e)),[a,o,i]=Dt(e,["follow-overlay-id","follow-overlay-position","hide-when-inactive"]);return{node:e,x:t,y:r,followOverlayId:a,followOverlayPosition:o,hideWhenInactive:f(i)}})(e)):"overlay"===t&&Z.push((e=>{const[t,r,a,o]=Dt(e,["x","y","width","height"]).map(e=>null==e?null:Number(e)),[i,n,s,l]=Dt(e,["selectable","movable","resizable","lock-aspect"]).map(f),c=e.getAttribute("type"),[d]=Dt(e,["id"]);return{id:d,x:t,y:r,width:a,height:o,selectable:i,movable:n,resizable:s,lockAspect:l,type:c}})(e)),"fs-image-viewer-control"===e.tagName.toLowerCase()?O.appendChild(e):e.remove()}),0===e.markers.size()&&e.markers.setAll($),0===e.overlays.size()&&e.overlays.setAll(Z),X(m),X(v),t=e,T.onclick=t.zoomIn,k.onclick=t.zoomOut,S.onclick=(()=>{t.rotation-=90}),D.onclick=(()=>{t.rotation+=90}),window.navigator.userAgent.match(/iPad/i)||window.navigator.userAgent.match(/iPhone/i)?(P.remove(),C.remove()):(P.onclick=(()=>{t.invert=!t.invert}),C.onclick=(()=>{jt(e,g)})),q(),Array.from(i.children).forEach(t=>e.appendChild(t)),e.credentials||(e.credentials="include"),o=!0)},updateControls(e){e?(T.remove(),k.remove()):(O.insertBefore(T,z),O.insertBefore(k,z))},updateFilters(e){if(window.navigator.userAgent.match(/iPad/i)||window.navigator.userAgent.match(/iPhone/i))return;const t=`invert(${e.invert?1:0}) brightness(${e.brightness}) contrast(${e.contrast});`,r=`-webkit-filter: ${t} -moz-filter: ${t} -o-filter: ${t} -ms-filter: ${t} filter: ${t} `;p.setAttribute("style",r+"-webkit-transform: translateZ(0); -webkit-perspective: 1000; -webkit-backface-visibility: hidden;")},updateToolsControl(e){e?O.insertBefore(L,N):L.remove()},setSource(e){for(a=e;p.firstChild;)p.removeChild(p.firstChild);r={}},setSingleImage({width:e,height:t}){V(e,t);const r=new Image;r.src=a,p.appendChild(r)},initTiles({width:e,height:t,lowestLevel:a,highestLevel:o}){V(e,t);for(let e=a;e<=o;e++){const t=document.createElement("div");t.classList.add("fs-image-viewer__level"),t.classList.add(`fs-image-viewer__level--level${e}`);const a={level:e,elem:t,tiles:{}};r[e]=a,p.appendChild(t)}},setMessage(e,t){X(E),x.innerText=e,Y.className=`fs-alert fs-alert--${t}`},clearMessage(){E.setAttribute("inactive",!0)},updateTiles(t){t&&t.forEach(t=>{const{level:a,tiles:o}=t,{elem:i,tiles:n}=r[a];o.forEach(t=>{if(!n[t.src]){const r=new Image,{src:a,left:o,top:s,width:l,height:c}=t;r.onerror=((e,t)=>r=>{const a=_(r),o=e.tagName.toLowerCase(),{status:i}=r,{message:n}=a,s=new CustomEvent(`${o}:image-error`,{detail:{message:n,src:t,status:i},bubbles:!0});e.dispatchEvent(s)})(e,a),r.src=a,Vt(r,o,s,l,c),n[a]=r,i.appendChild(r)}})})},updateOverlays(r){Object.keys(n).forEach(e=>{r[e]||(n[e].node.remove(),delete n[e])}),Object.keys(r).forEach(e=>{const t=r[e];let a=n[e];if(a)a.overlay=t;else{const r=document.createElement("div");r.className="fs-image-viewer__overlay",r.id=e,v.appendChild(r),a={overlay:t,node:r},n[e]=a}const{overlay:o,node:i}=a,{x:s,y:l,width:c,height:d,type:g}=o;Vt(i,s,l,c,d),g?i.setAttribute("type",g):i.removeAttribute("type")}),U(e.selectedOverlays.list()),F(t())},updateSelection(e){Object.keys(n).forEach(t=>{const r=n[t].node;e[t]?r.setAttribute("selected",""):r.removeAttribute("selected")});const t=Object.keys(e);U(t)},updateSelectionRects(e){Object.keys(s).forEach(t=>{if(!e[t]){const e=s[t];delete s[t],e.setAttribute("inactive",""),setTimeout(()=>e.remove(),300)}}),Object.keys(e).forEach(t=>{const r=e[t];let a=s[t];a||(a=document.createElement("div"),s[t]=a,a.setAttribute("inactive",""),w.appendChild(a),requestAnimationFrame(()=>X(a)));const{x:o,y:i,width:n,height:l}=r,{style:c}=a;c.width=`${n}px`,c.height=`${l}px`,c.transform=`translate(${o}px, ${i}px)`}),F(t())},updateSelectionHandles(e){c=e;const t=e&&e.type?e.type:"none";y.style.setProperty("--handle-color",`var(--color-${t}`),c?(W(),X(y)):y.setAttribute("inactive",!0)},updateIsDrawing(e){d=e,e?X(b):b.setAttribute("inactive",!0)},updateDragRectangle({start:t,end:r}){if(!d||!t)return;const{x:a,y:o,width:i,height:n}=Se(t,r),{width:s,height:l}=e.nativeSize,{style:c}=b;c.transform=`translate(${a*s}px, ${o*l}px)`,c.width=`${100*i}%`,c.height=`${100*n}%`},updateMarkers(e){const r=t();Object.keys(l).forEach(t=>{e[t]||(l[t].node.remove(),delete l[t])}),Object.keys(e).forEach(t=>{const r=e[t];l[t]||m.appendChild(r.node),l[t]=r}),F(r)},updateLocale(t){g=t,q(),e.querySelector(".fs-image-viewer__adjustments")&&jt(e,g)},setTransform(e){const r=t();e&&(u.style.transform=`matrix(${e.join(",")})`,F(r),c&&W())}}};const{POINT_UP:Ft,POINT_DOWN:Ut,POINT_MOVE:qt}=e.user;var Kt=({node:e,getViewManager:g,store:m,updater:u})=>{const p=e=>{let t=!1;return r=>{t||(e(r),t=!0,requestAnimationFrame(()=>{t=!1}))}},v=e=>t=>{t.preventDefault(),e(t)},h=(t,r)=>{const{top:a,left:o}=e.getBoundingClientRect();return{viewX:t-o,viewY:r-a}},f=(t,r,a,o)=>{if(!t)return;const{viewX:i,viewY:n}=h(a,o),{panX:s,panY:l,zoom:c}=t.getZoomTo(r,i,n);e.panZoom={panX:s,panY:l,zoom:c}},w=(e,t,r,a,o)=>{u(e,e=>{e?t.addEventListener(r,a,o):t.removeEventListener(r,a,o)})},y=e=>e.inDom,b=e=>y(e)&&!e.gridMode,_=e=>b(e)&&!e.startPoint,O=e=>!(e.noPan&&e.noZoom),E=e=>b(e)&&O(e),x=e=>b(e)&&(O(e)||e.selectedOverlays!==d.OBJECT);w(e=>y(e)&&e.listeningToKeyboard,document,"keydown",d=>{const g=e.gridMode;switch(d.keyCode){case t:if(!g)return;e.horizontal?e.gotoPreviousRow():e.index--;break;case r:if(!g)return;e.horizontal?e.gotoNextRow():e.index++;break;case a:if(!g)return;e.horizontal?e.index--:e.gotoPreviousRow();break;case o:if(!g)return;e.horizontal?e.index++:e.gotoNextRow();break;case s:g?e.zoomInGrid():e.zoomIn();break;case l:g?e.zoomOutGrid():e.zoomOut();break;case i:case n:if(e.gridMode=!g,e.gridMode===g)return;break;case c:return void(e.gridMode=!0);default:return}d.preventDefault()}),w(e=>b(e)&&!e.noZoom,e,"wheel",t=>{const{minZoom:r,maxZoom:a,zoom:o}=e,{deltaY:i,deltaMode:n,ctrlKey:s,clientX:l,clientY:c,target:d}=t;let m=i;s&&(m*=10),n&&(m*=4*Math.abs(i));const u=Math.max(Math.min(o-.001*m,a),r)-o;e.scrollingParent&&!s||e.noZoom||(t.preventDefault(),f(g(d.src),u,l,c))},{passive:!1});const A=(e,t)=>{const{clientX:r,clientY:a}=e,{viewX:o,viewY:i}=h(r,a),{x:n,y:s}=t.fromPixels(o,i);return{viewX:o,viewY:i,imgX:n,imgY:s}},I=({touches:e},t)=>{const r=[...e].map(e=>A(e,t)),[a,o]=r;if(!o)return a;const i=(a.viewX+o.viewX)/2,n=(a.viewY+o.viewY)/2,s=(a.imgX+o.imgX)/2,l=(a.imgY+o.imgY)/2,c=a.viewX-o.viewX,d=a.viewY-o.viewY;return{viewX:i,viewY:n,imgX:s,imgY:l,distance:Math.sqrt(Math.pow(c,2)+Math.pow(d,2))*t.getScale(),rotation:Math.atan2(d,c)}},R=Math.PI/180,M=(e,t)=>{const r=A(e,t);return r.distance=50*e.scale,r.rotation=e.rotation*R,r},T=t=>t&&t!==e&&(t.hasAttribute("interactive")||T(t.parentElement)),k=(e,t)=>r=>{const{src:a}=r.target,o=g(a);if(!o)return;const i=t(r,o);((e,t,r)=>{if(T(r.target))return;const{src:a,id:o}=r.target;t.id=o,t.src=a,m.dispatch({type:e,data:t})})(e,i,r)},z=e=>k(e,A),N=p(z(qt));void 0===e.ontouchstart&&w(_,e,"mousemove",N),e.addEventListener("mousedown",z(Ut));const L=(e,t)=>w(x,document,e,t);if(L("mousemove",N),L("mouseup",z(Ft)),e.addEventListener("dblclick",t=>{if(!T(t.target))if(e.gridMode){if(t.target.src){e.src=t.target.src;const r=e.tagName.toLowerCase(),a=new CustomEvent(`${r}:dblclick`,{detail:{src:e.src,index:e.index},bubbles:!0});e.dispatchEvent(a),t.preventDefault()}}else if(!e.noZoom&&!t.target.classList.contains("fs-image-viewer__overlay")){t.preventDefault();const r=g(t.target.src);f(r,.2*e.zoom,t.clientX,t.clientY)}}),void 0!==e.ontouchstart){const t=e=>t=>{const{touches:r}=t,{noPan:a,scrollingParent:o,selectedOverlays:i}=m.getState();r.length<=1&&(o||a)&&i===d.OBJECT||e(t)},r=(e,t,r)=>w(x,document,e,t,r);e.addEventListener("touchstart",k(Ut,I),{passive:!1}),r("touchmove",t(v(p(k(qt,I)))),{passive:!1}),r("touchend",z(Ft))}else e.addEventListener("gesturestart",v(k(Ut,M)),{passive:!1}),w(E,e,"gesturechange",v(p(k(qt,M))),{passive:!1}),w(E,e,"gestureend",v(k(Ft,M)))};const{OBJECT:Jt}=d,{DRAWING:Qt,MOVING:er,PANNING:tr,RESIZING:rr}=g;var ar=(e,t)=>{const r=(r,a,o=null,i=(()=>!0),n)=>{t(a,t=>{if(!i(t))return;const a=e.tagName.toLowerCase(),n=new CustomEvent(`${a}:${r}`,{detail:t,bubbles:!0});if(e.dispatchEvent(n),o){const e=o();e&&e(n)}},n)};r("column-count",e=>e.columnCount),r("draw",(e,t)=>{const{startPoint:r,currentPoint:a,behavior:o}=t;return e.behavior||o!==Qt?null:{start:r,end:a,rectangle:Se(r,a)}},()=>e.onDraw,e=>e),r("grid-mode",e=>e.gridMode),r("image-change",e=>{const t=e.currentImage,r=e.images[t];return{src:t,index:(r?r.order:null)||null}}),r("image-error",e=>{if(e.inDom&&e.images[e.currentImage]&&e.images[e.currentImage].error){const{message:t}=e.images[e.currentImage].error;return{message:t,src:e.currentImage}}return null},()=>e.onImageLoad,Boolean),r("image-load",e=>e.inDom&&e.images[e.currentImage],()=>e.onImageLoad,Boolean,(e,t)=>e===t),r("images-change",e=>e.ordering),r("overlay-selection",e=>e.selectedOverlays),r("overlay-change",(e,t)=>{const{behavior:r,selectedOverlays:a,overlays:o}=e,{behavior:i}=t;if(!(i!==er&&i!==rr||r)){const e={};return Object.keys(a).forEach(t=>e[t]=o[t]),{overlays:e}}if(r!==er&&r!==rr){const r=((e,t)=>{if(!e||t===e)return null;let r=null;const a={};return Object.keys(e).forEach(o=>{t[o]&&e[o]!==t[o]&&(a[o]=e[o],r=a)}),r})(e.overlays,t.overlays);return r&&{overlays:r}}return null},null,e=>null!=e),r("point",(e,t)=>{const{selectedOverlays:r,behavior:a}=e,{startPoint:o,behavior:i}=t;if(i!==tr||a){if(a||i||r!==Jt)return null}else if(t.dragHappened)return null;return o},()=>e.onPoint,e=>e),r("rotation",e=>180*e.rotation/Math.PI),r("zoom-pan",e=>({panX:e.panX,panY:e.panY,zoom:e.zoom}))};const or=(e,t,r,a,o)=>(e/t-.5)/r/a+o,ir=(e,t,r,a,o)=>((e-o)*r*a+.5)*t,nr=(e,t,r)=>e.map(([e,t],r)=>[e,t,r]).filter(([e,a])=>t(e)<=r&&t(e+a)>=0),sr=(e,t,r,a,o)=>{const i=[],n=Math.ceil(e/Math.pow(2,r-t)),s=o/n,l=a/n,c=n%a/n||l,d=Math.ceil(n/a)-1;let g=0,m=s,u=l;for(let e=0;e<=d;e++)e===d&&(u=c,m=0),i.push([e*l-g,u+m+g]),g=s;return i},lr=(e,t)=>{let r,a,o,i=.5,n=.5,s=1,l=0,c=Math.cos(l),d=Math.sin(l);const g=[],m=(e,t,r=0,a=0,o=1)=>({x:r+(e-r)*c-(t-a)*d*o,y:a+(e-r)*d*o+(t-a)*c}),u=e=>{let t,l,p,v,h,f,w,y,b;const _=()=>Math.min(r/p,a/v),O=()=>{const e=_();y=p*e/r,b=v*e/a};g.push(O);const E=e=>ir(e,r,y,s,i),x=e=>ir(e,a,b,s,n),A=e=>or(e,r,y,s,i),I=e=>or(e,a,b,s,n),R={getScale:_,getSize:u.getSize,setSize:u.setSize,getPanZoom:u.getPanZoom,setPanZoom:u.setPanZoom,getRotation:u.getRotation,setRotation:u.setRotation,setRelativeLevels:u.setRelativeLevels,getCanvasTransform:u.getCanvasTransform,getTransformMatrix:()=>{const e=c*s*y*r/p,t=d*s*b*a/v,o=r*(.5-i*y*s),l=a*(.5-n*b*s),{x:g,y:u}=m(o,l,.5*r,.5*a);return[e,t,-t,e,g,u]},toPixels:(e,t)=>m(E(e),x(t),.5*r,.5*a),fromPixels:(e,t)=>{const{x:o,y:i}=m(e,t,.5*r,.5*a,-1);return{x:A(o),y:I(i)}},getFootprint:()=>({x:E(0),y:x(0),width:r*y*s,height:a*b*s}),getPanTo:(e,t)=>{const{x:o,y:l}=m(e,t,0,0,-1);return{panX:i-o/r/s/y,panY:n-l/a/s/b}},panTo:(e,t)=>{const r=R.getPanTo(e,t);({panX:i,panY:n}=r)},getZoomTo:(e,t,r)=>{const{x:a,y:o}=R.fromPixels(t,r);return{zoom:s+s*e,panX:i+(a-i)*e/(e+1),panY:n+(o-n)*e/(e+1)}},zoomTo:(e,t,r)=>{const a=R.getZoomTo(e,t,r);({panX:i,panY:n,zoom:s}=a)},getTopZoomLevel:()=>Math.log2(Math.max(p,v)),getVisibleTiles:()=>{const e=R.getTopZoomLevel(),i=s*y*r/p,n=e+Math.floor(Math.log2(i)),c=((e,t,r)=>e.map(e=>Math.floor(e+t)).map(e=>Math.max(e,8)).map(e=>Math.min(e,Math.ceil(r))).sort((e,t)=>e-t).filter((e,t,r)=>t===r.indexOf(e)))(o,n,e).map(o=>{const i=nr(sr(p,o,Math.ceil(e),h,w),E,r),n=nr(sr(v,o,Math.ceil(e),h,w),x,a),s=[];return n.forEach(([e,r,a])=>{i.forEach(([i,n,c])=>{s.push({src:`${t}/${o}/${c}_${a}.${f}${l}`,left:i,top:e,width:n,height:r})})}),{level:o,tiles:s}});return c.toPixels=(()=>c.map(e=>({level:e.level,tiles:e.tiles.map(e=>({src:e.src,left:E(e.left),top:x(e.top),width:e.width*s*y*r,height:e.height*s*b*a}))}))),c},setImage:({tilePath:e,query:r,width:a=null,height:o=null,tileSize:i=256,overlap:n=1,format:s="jpg"}={})=>{if(!a||!o)throw new Error("Must set width and height at least");t=e,l=r,p=a,v=o,h=i,w=n,f=s,O()}};return e&&R.setImage(e),R};return u.getSize=(()=>({width:r,height:a})),u.setSize=((e,t)=>{r=e,a=t,g.forEach(e=>e())}),u.getPanZoom=(()=>({zoom:s,panX:i,panY:n})),u.setPanZoom=((e,t,r=s)=>{i=e,n=t,s=r}),u.getRotation=(()=>l),u.setRotation=(e=>{l=e,d=Math.sin(l),c=Math.cos(l)}),u.getCanvasTransform=(()=>{const{x:e,y:t}=m(0,0,.5*r,.5*a);return[c,d,-d,c,e,t]}),u.setRelativeLevels=((...e)=>{o=[...e]}),u.setSize(e,t),u.setPanZoom(.5,.5),u.setRelativeLevels(0),u},{VIEW_SIZE:cr,IN_DOM:dr}=e,{ERROR:gr}=m;var mr=e=>{const t=(e=>{let t=e(),r=!1;return{dispatch:a=>{if(r)throw new Error(`*** Reducers are not allowed to dispatch, but received ${a.type}.`);try{r=!0,t=e(t,a)}catch(e){console.error("*** State update error: ***",e)}finally{r=!1}},getState:()=>t}})(((...e)=>{e.forEach((e,t)=>{if("function"!=typeof e)throw new Error(`Reducer in argument ${t+1} is not a function.`)});const t=e.reduce((e,t)=>Object.assign(e,t()),{});return(r=t,a)=>e.reduce((e,t)=>t(e,a),r)})(Ne,et,ot,Fe,gt,At)),r=lr(e.clientWidth,e.clientHeight);r.setRelativeLevels(.5,2);const a=r();X(e,t),((e,{dispatch:t,getState:r})=>{Object.defineProperties(e,{overlays:{get:()=>({add:e=>t({type:U,data:ee(e)}),addAndSelect:e=>{const r=ee(e);t({type:U,data:r}),t({type:J.CLEAR,data:null}),t({type:J.ADD,data:[r.id]})},clear:()=>t({type:F,data:[]}),delete:e=>t({type:K,data:w(e)}),get:e=>{if(r().overlays[e])return Object.assign({},r().overlays[e])},getAll:()=>{const{overlays:e}=r(),t={};return Object.keys(e).forEach(r=>{t[r]=Object.assign({},e[r])}),t},setAll:e=>{if(!Array.isArray(e))throw Error(`Expected an array, got ${typeof e}.`);t({type:F,data:e.map(ee)})},size:()=>Object.keys(r().overlays).length,update:e=>t({type:q,data:e})}),set:t=>e.overlays.setAll(t)}});const a=(a,{ADD:o,REMOVE:i,CLEAR:n})=>{Object.defineProperty(e,a,{value:{add:(...e)=>{const{overlays:a}=r(),i=e.map(w).filter(e=>a[e]);t({type:o,data:i})},addAll:()=>t({type:o,data:Object.keys(r().overlays)}),contains:e=>Boolean(r()[a][e]),clear:()=>t({type:n,data:null}),list:()=>Object.keys(r()[a]),remove:(...e)=>t({type:i,data:e.map(w)}),size:()=>e[a].list().length}})};a("selectedOverlays",J),a("highlightedOverlays",Q)})(e,t),((e,{dispatch:t,getState:r})=>{Object.defineProperties(e,{markers:{get:()=>({add:e=>t({type:re,data:ie(e)}),clear:()=>t({type:te,data:[]}),delete:e=>t({type:oe,data:w(e)}),get:e=>{if(r().markers[e])return Object.assign({},r().markers[e])},getAll:()=>{const{markers:e}=r(),t={};return Object.keys(e).forEach(r=>{t[r]=Object.assign({},e[r])}),t},setAll:e=>{if(!Array.isArray(e))throw Error(`Expected an array, got ${typeof e}`);t({type:te,data:e.map(ie)})},size:()=>Object.keys(r().markers).length,update:e=>t({type:ae,data:e})}),set:t=>e.markers.setAll(t)}})})(e,t),e.fromPixels=a.fromPixels,e.toPixels=a.toPixels;const o=kt(()=>{const{clientWidth:r,clientHeight:a}=e;return t.dispatch({type:cr,data:{viewWidth:r,viewHeight:a}}),t.getState()});o(e=>{const{viewWidth:t,viewHeight:r}=e;return{viewWidth:t,viewHeight:r}},({viewWidth:e,viewHeight:t})=>{r.setSize(e,t)});o(e=>{const{panX:t,panY:r,zoom:a}=e;return{panX:t,panY:r,zoom:a}},({panX:e,panY:t,zoom:a})=>{r.setPanZoom(e,t,a)}),o(e=>e.rotation,r.setRotation);const i=Wt(e,()=>a);e.initialize=(()=>{t.dispatch({type:dr,data:!0}),i.initialize()}),e.tearDown=(()=>t.dispatch({type:dr,data:!1})),o(e=>e.currentImage,e=>{i.setSource(e)});o(e=>({invert:e.invert,brightness:e.brightness,contrast:e.contrast}),e=>i.updateFilters(e));o(e=>{const{message:t,currentImage:r,images:a}=e,o=a[r];return o&&o.error?{text:o.error.message,type:gr}:t},e=>{if(e){const{text:t,type:r}=e;i.setMessage(t,r)}else i.clearMessage()});const n=e=>{const{images:t,currentImage:r}=e;return t[r]};o(n,t=>{if(t&&!t.error&&e.src)if(a.setImage(t),t.tilePath){const{width:e,height:r}=t,o=8,n=Math.ceil(a.getTopZoomLevel());i.initTiles({width:e,height:r,lowestLevel:o,highestLevel:n})}else i.setSingleImage(t)},(e,t)=>e===t);o(e=>{const t=n(e);return a&&t&&t.dzi?a.getVisibleTiles():null},i.updateTiles);o(e=>e.overlays,i.updateOverlays);o(e=>e.selectedOverlays,i.updateSelection);o(e=>{const t=e.selectedOverlays,r=e.highlightedOverlays,o=new Set(Object.keys(t).concat(Object.keys(r)));e.currentHoveredOverlay&&o.add(e.currentHoveredOverlay);const i={};return o.forEach(t=>{const r=e.overlays[t],{x:o,y:n}=a.toPixels(r.x,r.y),{x:s,y:l}=a.toPixels(r.x+r.width,r.y+r.height),c=s-o,d=l-n;i[t]={x:o,y:n,width:c,height:d}}),i},i.updateSelectionRects);o(({selectedOverlays:e,overlays:t})=>{const r=Object.keys(e).map(e=>t[e]);return r.length?r.reduce((e,t)=>{const{x:r,y:a,width:o,height:i,type:n}=t,s=r+o,l=a+i;return{xmin:e.xmin<r?e.xmin:r,ymin:e.ymin<a?e.ymin:a,xmax:e.xmax>s?e.xmax:s,ymax:e.ymax>l?e.ymax:l,type:e.type&&e.type!==n?"multi":n}},{xmin:1/0,ymin:1/0,xmax:-1/0,ymax:-1/0}):null},i.updateSelectionHandles);o(({startPoint:e,currentPoint:t})=>({start:e,end:t}),i.updateDragRectangle);o(({behavior:e})=>e===g.DRAWING,i.updateIsDrawing);o(e=>e.markers,i.updateMarkers),o(()=>a?a.getTransformMatrix():null,i.setTransform),o(e=>e.noZoom,e=>i.updateControls(e)),o(e=>e.toolsControl,e=>i.updateToolsControl(e)),o(e=>e.locale,e=>i.updateLocale(e)),Kt({node:e,getViewManager:()=>a,store:t,updater:o}),ar(e,o)};const ur="fs-single-image-viewer";if(!customElements.get(ur)){class e extends HTMLElement{constructor(){super(),mr(this)}connectedCallback(){setTimeout(this.initialize,0)}disconnectedCallback(){this.tearDown()}static get observedAttributes(){return["src","zoom","pan-x","pan-y","min-zoom","max-zoom","rotation","no-pan","no-rotate","no-zoom","on-image-load","on-point","on-draw","listening-to-keyboard","credentials","scrolling-parent","invert","brightness","contrast","tools-control"]}attributeChangedCallback(e,t,r){const a=y(e);switch(a){case"onImageLoad":case"onPoint":case"onDraw":this[a]=r?Function("event",r):null;break;default:this[a]=r}}}customElements.define(ur,e)}}();
